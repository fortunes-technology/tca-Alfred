'use strict';

var _regeneratorRuntime = require('babel-runtime/regenerator')['default'];

var _Object$assign = require('babel-runtime/core-js/object/assign')['default'];

var _interopRequireDefault = require('babel-runtime/helpers/interop-require-default')['default'];

Object.defineProperty(exports, '__esModule', {
  value: true
});

var _lodash = require('lodash');

var _lodash2 = _interopRequireDefault(_lodash);

exports['default'] = function (schema, defaults) {
  schema.methods.update = function callee$1$0(source) {
    var permitted = arguments.length <= 1 || arguments[1] === undefined ? defaults : arguments[1];
    return _regeneratorRuntime.async(function callee$1$0$(context$2$0) {
      while (1) switch (context$2$0.prev = context$2$0.next) {
        case 0:
          _Object$assign(this, permitted ? _lodash2['default'].pick(source, permitted) : source);
          context$2$0.next = 3;
          return _regeneratorRuntime.awrap(this.save());

        case 3:
          return context$2$0.abrupt('return', this);

        case 4:
        case 'end':
          return context$2$0.stop();
      }
    }, null, this);
  };
  schema.statics.getPermitted = function () {
    var permitted = arguments.length <= 0 || arguments[0] === undefined ? defaults : arguments[0];

    return permitted;
  };
};

module.exports = exports['default'];